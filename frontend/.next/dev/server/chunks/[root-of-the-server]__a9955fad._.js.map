{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 64, "column": 0}, "map": {"version":3,"sources":["file:///Users/dpang/dev/grokipedia-research/frontend/app/api/videos/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server'\nimport { readdir, readFile } from 'fs/promises'\nimport { join, resolve } from 'path'\nimport { existsSync } from 'fs'\n\n// Resolve paths relative to the project root (one level up from frontend)\nconst PROJECT_ROOT = resolve(process.cwd(), '..')\nconst VIDEOS_DIR = join(PROJECT_ROOT, 'paper-manim-viz-explanations/deepseek-moe-explainer/generated_videos/spmoe_architecture')\nconst SUMMARIES_DIR = join(PROJECT_ROOT, 'paper-manim-viz-explanations/deepseek-moe-explainer/chunk-summary/spmoe_architecture')\n\ninterface VideoItem {\n  id: string\n  title: string\n  description: string\n  videoPath: string\n  chunkNumber: number\n  header: string\n}\n\nexport async function GET() {\n  try {\n    // Verify directories exist\n    if (!existsSync(VIDEOS_DIR)) {\n      console.error(`VIDEOS_DIR does not exist: ${VIDEOS_DIR}`)\n      return NextResponse.json({ error: `Videos directory not found: ${VIDEOS_DIR}` }, { status: 500 })\n    }\n    if (!existsSync(SUMMARIES_DIR)) {\n      console.error(`SUMMARIES_DIR does not exist: ${SUMMARIES_DIR}`)\n      return NextResponse.json({ error: `Summaries directory not found: ${SUMMARIES_DIR}` }, { status: 500 })\n    }\n    \n    const videoItems: VideoItem[] = []\n    \n    // Get all chunk directories\n    const chunkDirs = await readdir(VIDEOS_DIR, { withFileTypes: true })\n    const chunkDirsList = chunkDirs\n      .filter(dirent => dirent.isDirectory())\n      .map(dirent => dirent.name)\n      .filter(name => name.startsWith('chunk_'))\n      .sort()\n\n    for (const chunkDir of chunkDirsList) {\n      // Extract chunk number and name\n      const match = chunkDir.match(/chunk_(\\d+)_(.+)/)\n      if (!match) continue\n      \n      const chunkNumber = parseInt(match[1], 10)\n      const chunkName = match[2]\n      \n      // Check if video exists\n      const videoPath = join(VIDEOS_DIR, chunkDir, 'video.mp4')\n      if (!existsSync(videoPath)) continue\n      \n      // Read corresponding markdown summary\n      const summaryPath = join(SUMMARIES_DIR, `${chunkDir}_summary.md`)\n      let title = chunkName.replace(/_/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase())\n      let description = ''\n      // Extract header from filename: text between chunk_ and .md\n      // For chunk_01_deepseekmoe_overview_summary.md, header is 01_deepseekmoe_overview_summary\n      const summaryFilename = `${chunkDir}_summary.md`\n      const headerMatch = summaryFilename.match(/chunk_(.+)\\.md/)\n      const header = headerMatch ? headerMatch[1] : chunkName\n      \n      if (existsSync(summaryPath)) {\n        try {\n          const summaryContent = await readFile(summaryPath, 'utf-8')\n          // Extract title from first heading\n          const titleMatch = summaryContent.match(/^#\\s+(.+)$/m)\n          if (titleMatch) {\n            title = titleMatch[1]\n          }\n          // Extract first paragraph as description\n          const paragraphs = summaryContent.split('\\n\\n').filter(p => p.trim() && !p.startsWith('#'))\n          if (paragraphs.length > 0) {\n            description = paragraphs[0].replace(/\\n/g, ' ').trim().substring(0, 200)\n            if (paragraphs[0].length > 200) {\n              description += '...'\n            }\n          }\n        } catch (error) {\n          console.error(`Error reading summary for ${chunkDir}:`, error)\n        }\n      }\n      \n      videoItems.push({\n        id: `chunk_${chunkNumber}`,\n        title,\n        description,\n        videoPath: `/api/video/${chunkDir}`,\n        chunkNumber,\n        header,\n      })\n    }\n    \n    return NextResponse.json({ videos: videoItems })\n  } catch (error) {\n    console.error('Error loading videos:', error)\n    return NextResponse.json({ error: 'Failed to load videos' }, { status: 500 })\n  }\n}\n\n"],"names":[],"mappings":"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"}}]
}